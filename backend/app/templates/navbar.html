<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">Restaurant</a>

    <button class="navbar-toggler" type="button"
            data-bs-toggle="collapse" data-bs-target="#navbarMain"
            aria-controls="navbarMain" aria-expanded="false"
            aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarMain">
      <ul class="navbar-nav ms-auto align-items-lg-center">

        <li class="nav-item me-3">
          <form method="POST" action="{{ url_for('main.set_language') }}" class="d-flex gap-2 align-items-center">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <input type="hidden" name="next" value="{{ request.path }}{% if request.query_string %}?{{ request.query_string.decode('utf-8') }}{% endif %}">

            <select name="lang" class="form-select form-select-sm" onchange="this.form.submit()">
              {% set current_lang = session.get('lang', 'en') %}
              <option value="en" {% if current_lang == 'en' %}selected{% endif %}>English</option>
              <option value="it" {% if current_lang == 'it' %}selected{% endif %}>Italiano</option>
              <option value="fr" {% if current_lang == 'fr' %}selected{% endif %}>Français</option>
              <option value="es" {% if current_lang == 'es' %}selected{% endif %}>Español</option>
              <option value="de" {% if current_lang == 'de' %}selected{% endif %}>Deutsch</option>
            </select>
          </form>
        </li>

        {% if current_user.is_authenticated %}
          <li class="nav-item"><a class="nav-link" href="/menu">Menu</a></li>
          <li class="nav-item"><a class="nav-link" href="/orders">My Orders</a></li>

          <li class="nav-item">
            <form method="POST" action="{{ url_for('auth.logout') }}" class="d-inline">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
              <button type="submit" class="nav-link btn btn-link p-0" style="text-decoration: none;">
                Logout
              </button>
            </form>
          </li>
        {% else %}
          <li class="nav-item"><a class="nav-link" href="/login">Login</a></li>
          <li class="nav-item"><a class="nav-link" href="/register">Register</a></li>
        {% endif %}
      </ul>
    </div>
  </div>
</nav>
